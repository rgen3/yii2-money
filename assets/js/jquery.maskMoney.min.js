!function(e){"use strict";function n(e,n){var t="";return e.indexOf("-")>-1&&(e=e.replace("-",""),t="-"),e.indexOf(n.prefix)>-1&&(e=e.replace(n.prefix,"")),e.indexOf(n.suffix)>-1&&(e=e.replace(n.suffix,"")),t+n.prefix+e+n.suffix}function t(e,n){return n.allowEmpty&&""===e?"":n.reverse?r(e,n):a(e,n)}function a(e,t){var a,r,o,s=e.indexOf("-")>-1&&t.allowNegative?"-":"",l=e.replace(/[^0-9]/g,""),c=l.slice(0,l.length-t.precision);if(a=i(c,s,t),t.precision>0){if(!isNaN(e)&&e.indexOf(".")){var u=e.substr(e.indexOf(".")+1);a=i(c=(l+=new Array(t.precision+1-u.length).join(0)).slice(0,l.length-t.precision),s,t)}r=l.slice(l.length-t.precision),o=new Array(t.precision+1-r.length).join(0),a+=t.decimal+o+r}return n(a,t)}function r(e,t){var a,r=e.indexOf("-")>-1&&t.allowNegative?"-":"",o=e.replace(t.prefix,"").replace(t.suffix,""),s=o.split(t.decimal)[0],l="";if(""===s&&(s="0"),a=i(s,r,t),t.precision>0){var c=o.split(t.decimal);c.length>1&&(l=c[1]),a+=t.decimal+l;var u=Number.parseFloat(s+"."+l).toFixed(t.precision).toString().split(t.decimal)[1];a=a.split(t.decimal)[0]+"."+u}return n(a,t)}function i(e,n,t){return e=e.replace(/^0*/g,""),""===(e=e.replace(/\B(?=(\d{3})+(?!\d))/g,t.thousands))&&(e="0"),n+e}e.browser||(e.browser={},e.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),e.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()),e.browser.device=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));var o={prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1,doubleClickSelection:!0,allowEmpty:!1,bringCaretAtEndOnFocus:!0},s={destroy:function(){return e(this).unbind(".maskMoney"),e.browser.msie&&(this.onpaste=null),this},applyMask:function(n){return t(n,e(this).data("settings"))},mask:function(n){return this.each(function(){var t=e(this);return"number"==typeof n&&t.val(n),t.trigger("mask")})},unmasked:function(){return this.map(function(){var n,t=e(this).val()||"0",a=-1!==t.indexOf("-");return e(t.split(/\D/).reverse()).each(function(e,t){if(t)return n=t,!1}),t=t.replace(/\D/g,""),t=t.replace(new RegExp(n+"$"),"."+n),a&&(t="-"+t),parseFloat(t)})},unmaskedWithOptions:function(){return this.map(function(){var n=e(this).val()||"0",t=e(this).data("settings")||o,a=new RegExp(t.thousandsForUnmasked||t.thousands,"g");return n=n.replace(a,""),parseFloat(n)})},init:function(a){return a=e.extend(e.extend({},o),a),this.each(function(){function r(){var e,n,t,a,r,i=y.get(0),o=0,s=0;return"number"==typeof i.selectionStart&&"number"==typeof i.selectionEnd?(o=i.selectionStart,s=i.selectionEnd):(n=document.selection.createRange())&&n.parentElement()===i&&(a=i.value.length,e=i.value.replace(/\r\n/g,"\n"),(t=i.createTextRange()).moveToBookmark(n.getBookmark()),(r=i.createTextRange()).collapse(!1),t.compareEndPoints("StartToEnd",r)>-1?o=s=a:(o=-t.moveStart("character",-a),o+=e.slice(0,o).split("\n").length-1,t.compareEndPoints("EndToEnd",r)>-1?s=a:(s=-t.moveEnd("character",-a),s+=e.slice(0,s).split("\n").length-1))),{start:o,end:s}}function i(){var e=!(y.val().length>=y.attr("maxlength")&&y.attr("maxlength")>=0),n=r(),t=n.start,a=n.end,i=!(n.start===n.end||!y.val().substring(t,a).match(/\d/)),o="0"===y.val().substring(0,1);return e||i||o}function o(e){b.formatOnBlur||y.each(function(n,t){if(t.setSelectionRange)t.focus(),t.setSelectionRange(e,e);else if(t.createTextRange){var a=t.createTextRange();a.collapse(!0),a.moveEnd("character",e),a.moveStart("character",e),a.select()}})}function s(e){var n,a=y.val().length;y.val(t(y.val(),b)),n=y.val().length,b.reverse||(e-=a-n),o(e)}function l(){var e=y.val();if(!b.allowEmpty||""!==e){var n=!isNaN(e)?e.indexOf("."):e.indexOf(b.decimal);if(b.precision>0)if(n<0)e+=b.decimal+new Array(b.precision+1).join(0);else{var a=e.slice(0,n),r=e.slice(n+1);e=a+b.decimal+r+new Array(b.precision+1-r.length).join(0)}else n>0&&(e=e.slice(0,n));y.val(t(e,b))}}function c(){var e=y.val();return b.allowNegative?""!==e&&"-"===e.charAt(0)?e.replace("-",""):"-"+e:e}function u(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function d(e){var n=(e=e||window.event).which||e.charCode||e.keyCode,t=b.decimal.charCodeAt(0);return void 0!==n&&(!(n<48||n>57)||n===t&&b.reverse?!!i()&&((n!==t||!f())&&(!!b.formatOnBlur||(u(e),g(e),!1))):m(n,e))}function f(){return!v()&&p()}function v(){var e=y.val().length,n=r();return 0===n.start&&n.end===e}function p(){return y.val().indexOf(b.decimal)>-1}function g(e){var n,t,a,i,o=(e=e||window.event).which||e.charCode||e.keyCode,l="";o>=48&&o<=57&&(l=String.fromCharCode(o)),t=(n=r()).start,a=n.end,i=y.val(),y.val(i.substring(0,t)+l+i.substring(a,i.length)),s(t+1)}function m(n,t){return 45===n?(y.val(c()),!1):43===n?(y.val(y.val().replace("-","")),!1):13===n||9===n||(!(!e.browser.mozilla||37!==n&&39!==n||0!==t.charCode)||(u(t),!0))}function h(){setTimeout(function(){l()},0)}function w(){return(parseFloat("0")/Math.pow(10,b.precision)).toFixed(b.precision).replace(new RegExp("\\.","g"),b.decimal)}var b,x,y=e(this);b=e.extend({},a),b=e.extend(b,y.data()),y.data("settings",b),e.browser.device&&y.attr("type","tel"),y.unbind(".maskMoney"),y.bind("keypress.maskMoney",d),y.bind("keydown.maskMoney",function(e){var n,t,a,i,o,l=(e=e||window.event).which||e.charCode||e.keyCode;return void 0!==l&&(n=r(),t=n.start,a=n.end,8!==l&&46!==l&&63272!==l||(u(e),i=y.val(),t===a&&(8===l?""===b.suffix?t-=1:(o=i.split("").reverse().join("").search(/\d/),a=1+(t=i.length-o-1)):a+=1),y.val(i.substring(0,t)+i.substring(a,i.length)),s(t),!1))}),y.bind("blur.maskMoney",function(t){if(e.browser.msie&&d(t),b.formatOnBlur&&y.val()!==x&&g(t),""===y.val()&&b.allowEmpty)y.val("");else if(""===y.val()||y.val()===n(w(),b))b.allowZero?b.affixesStay?y.val(n(w(),b)):y.val(w()):y.val("");else if(!b.affixesStay){var a=y.val().replace(b.prefix,"").replace(b.suffix,"");y.val(a)}y.val()!==x&&y.change()}),y.bind("focus.maskMoney",function(){x=y.val(),l();var e,n=y.get(0);b.selectAllOnFocus?n.select():n.createTextRange&&b.bringCaretAtEndOnFocus&&((e=n.createTextRange()).collapse(!1),e.select())}),y.bind("click.maskMoney",function(){var e,n=y.get(0);b.selectAllOnFocus||(n.setSelectionRange&&b.bringCaretAtEndOnFocus?(e=y.val().length,n.setSelectionRange(e,e)):y.val(y.val()))}),y.bind("dblclick.maskMoney",function(){var e,n,t=y.get(0);t.setSelectionRange&&b.bringCaretAtEndOnFocus?(n=y.val().length,e=b.doubleClickSelection?0:n,t.setSelectionRange(e,n)):y.val(y.val())}),y.bind("cut.maskMoney",h),y.bind("paste.maskMoney",h),y.bind("mask.maskMoney",l)})}};e.fn.maskMoney=function(n){return s[n]?s[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.maskMoney"):s.init.apply(this,arguments)}}(window.jQuery||window.Zepto);
